{% load i18n %}
<div class="modal fade {{ req_action }}" id="captionmakerModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content" id="accordeon">
    {% if req_action == 'modal_load' %}
    <form method="post" action="{% url 'video_caption_maker' slug=video.slug %}" id="captionmaker_form" class="{{ req_action }}">
    {% endif %}
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"> <span aria-hidden="true">&times;</span> </button>
      </div>
      <div class="modal-body">

        {% if messages %}
        <div id="base-message-alert">
        {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
          {{ message }}
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">&times;</span> </button>
        </div>
        {% endfor %}
        </div>
        {% endif %}
        {% if req_action == 'modal_save' %}
        <div class="contenuTitre">
          <span id="list_track"> {% include 'track/list_track.html' with dest='video_caption_maker' action_modify_name='form_save_modify' %} </span>
          &nbsp;
          <span id="form_track"> {% if form_track %} {% include 'track/form_track.html' with form_track=form_track %} {% endif %} </span>
          <form class="form_new completion" id="form_new_track" action="{% url 'video_caption_maker' slug=video.slug %}" method="POST">
            {% csrf_token %}
            <input type="hidden" name="action" value="form_save_new"/>
            <input type="submit" value="{% trans 'Add a new subtitle or caption file' %}" class="new_track btn btn-info"/>
          </form>
        </div>
        {% endif %}

        {% if req_action == 'modal_load' %}
        {% csrf_token %}
        <fieldset>
            {% if form_make_caption.errors %} <p class="text-danger">{% trans "One or more errors have been found in the form." %}</p> {% endif %}
            {% for field_hidden in form_make_caption.hidden_fields %} {{field_hidden}} {% endfor %}
            {% for field in form_make_caption.visible_fields %}
              {% spaceless %}
              <div class="form-group" >
                  {{ field.errors }}
                  {{ field }}
                  {% if field.help_text %} <small id="{{field.id_for_label}}Help" class="form-text text-muted">{{ field.help_text|safe }}</small> {% endif %}
                  {% if field.field.required %} <div class="invalid-feedback">{% trans "Please provide a valid value for this field" %}.</div> {%endif%}
              </div>
              {% endspaceless %}
            {% endfor %}
            {% if form_make_caption.instance.id %} <input type="hidden" id="user_id" name="user_id" value="{{form_make_caption.instance.id}}"/> {% endif %}
            <input type="hidden" name="action" value="{{ req_action }}"/>
        </fieldset>
        {{form_make_caption.media}}
        {% endif %}
        
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        {% if req_action == 'modal_load' %} <button type="submit" class="btn btn-primary">Save changes</button> {% endif %}
      </div>
    </form>
    </div>
  </div>
</div>